<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />

    <title>Aristotle</title>
    <script>
        // This JS will need to be hosted on the App host page within Aristotle.
        // Token is provided by Django (SSR), or alternatively, extract from a cookie (similiar to original JS)
        let token = 'bef763a4cab92bdf9f52c3506f3edb74307ae514';

        const postMessageToApp = (data) => {
            document
                .querySelector("#app")
                .contentWindow
                .postMessage(data)
        }

        window.setInterval(function() {
            // TODO: Refresh the token
            postMessageToApp({ argusMessageId: "argus-token-refresh", token })
        }, 5000)

        window.addEventListener("message", (event) => {
            if (event.data.argusMessageId === "argus-token-request") {
                postMessageToApp({ 
                    argusMessageId: "argus-token-response",
                    requestId: event.data.requestId,
                    token 
                })
            }
        }, false);
    </script>
</head>

<body>
    <h1>Aristotle</h1>
    <p>This example assumes there is an Aristotle running on localhost:8000</p>
    <hr />
    <iframe id="app" src="/example/app.html" width="100%" height="600px"></iframe>
</body>

</html>